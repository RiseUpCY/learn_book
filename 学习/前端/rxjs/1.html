<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="./rxjs.js"></script>
    </head>
    <body>
        <script>
            let { of, Observable, from, interval, pipe, Subject } = rxjs;
            let { map, first, concatAll, exhaust, filter, multicast } = rxjs.operators;

            const source = interval(1000)
            const subject = new Subject()

            const mulitcasted = source.pipe(multicast(subject))

            let s1 = mulitcasted.subscribe(x => console.log('A: ' + x))
            let s2;

            let connect = mulitcasted.connect()
            
            setTimeout(() => {
                s2 = mulitcasted.subscribe(y => console.log('BBBBB: ' + y))    
            }, 2500)

            // 清理
            setTimeout(() => {
                s2.unsubscribe()
            }, 5000)

            setTimeout(() => {
                s1.unsubscribe()
                connect.unsubscribe()
            }, 8000);
            

        </script>
    </body>
</html>
